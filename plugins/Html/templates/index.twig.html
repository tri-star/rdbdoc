{% extends "layout.twig.html" %}

{% block content %}

<style>
    h2 {
        Border-left: 4px solid #444;
        border-bottom: 1px solid #444;
        padding-left: 5px;
        padding-bottom: 5px;
        padding-top: 5px;
        margin-top: 20px;
        margin-bottom: 15px;
        background-color: #d9edf7;
    }

    h3 {
        border-bottom: 1px solid #888;
        padding-left: 5px;
        padding-bottom: 5px;
        padding-top: 5px;
        margin-top: 20px;
        margin-bottom: 10px;
    }

</style>

<h1>テーブル定義書</h1>

<h2>目次</h2>

<ul>
    <li><a href="#db-desc">データベース情報</a></li>
    <li>
        <a href="#db-desc">テーブル一覧</a>
        <ul>
            {% for table in db.getTables() %}
            <li><a href="#table-{{ table.getName() }}">{{ table.getName() }}</a></li>
            {% endfor %}
        </ul>
    </li>
</ul>

<div class="row">
    <h2 id="db-desc">データベース情報</h2>

    <table class="table table-bordered">
        <tr class="active">
            <th style="width: 150px;">データベース名</th>
            <td>{{ db.getName() }}</td>
        </tr>
        <tr>
            <th>概要</th>
            <td>{{ db.getDescription() }}</td>
        </tr>
    </table>
</div>


<div class="row">
    <h2 id="tables">テーブル一覧</h2>

    <table class="table table-bordered">
        <tr class="active">
            <th style="width: 150px;">テーブル名</th>
            <th style="width: 150px;">論理名</th>
            <th>ENGINE</th>
            <th>ROWS</th>
            <th>AUTO_INC</th>
            <th>概要</th>
        </tr>
        {% for table in db.getTables() %}
        <tr>
            <td><a href="#table-{{ table.getName() }}">{{ table.getName() }}</a></td>
            <td>{{ table.getLogicalName() }}</td>
            <td>{{ table.getMetaData().engine }}&nbsp;<span class="text-muted">({{ table.getMetaData().row_format }})</span></td>
            <td class="text-right">{{ table.getMetaData().rows|number_format }}</td>
            <td class="text-right">{{ table.getMetaData().auto_increment|number_format }}</td>
            <td>{{ table.getDescription() }}</td>
        </tr>
        {% endfor %}
    </table>

</div>


<div class="row">
    <h2>テーブル詳細</h2>

    {% for table in db.getTables() %}


    <h3 id="table-{{ table.getName() }}">{{ table.getName() }} テーブル</h3>
    <p>{{ table.getDescription()|nl2br }}</p>

    <table class="table table-bordered">
        <tr class="active">
            <th style="width: 150px;">カラム名</th>
            <th style="width: 150px;">名前</th>
            <th style="width: 150px;">データ型</th>
            <th style="width: 150px;">デフォルト値</th>
            <th>説明</th>
        </tr>
        {% for column in table.getColumns() %}
        <tr>
            <td>{{ column.getName() }}</td>
            <td>{{ column.getLogicalName() }}</td>
            <td>{{ column.getType() }}</td>
            <td>{{ column.getDefault() }}</td>
            <td>{{ column.getDescription()|nl2br }}</td>
        </tr>
        {% endfor %}
    </table>


    <h4>メタ情報</h4>
    <table class="table table-bordered">
        <tr class="active">
            <th style="width: 150px;">キー</th>
            <th>値</th>
        </tr>
        {% for key, value in table.getMetaData() %}
        <tr>
            <td>{{ key }}</td>
            <td>{{ value }}</td>
        </tr>
        {% endfor %}
    </table>

    {% endfor %}

</div>


{% endblock %}
